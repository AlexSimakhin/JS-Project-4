!function(){"use strict";var e={6295:function(e,t,n){n(1539),n(8674),n(5666),n(3371),n(9714);var r=n(8901),a=n.n(r),o="https://lab.lectrum.io/js2/api/crm",i=function(){return localStorage.getItem("token")},c=(n(8309),dropdownClient.querySelector(".dropdown__list")),s=document.getElementById("dealClient"),l=document.getElementById("dealTel"),u=document.getElementById("dealMail"),d=document.getElementById("dealExecutor"),f=managerNames.querySelector(".executor__img"),m=dropdownTags.querySelector(".dropdown__list"),p=dropdownTags.querySelector(".priority__circle"),h=managerNames.querySelector(".dropdown__list"),v=managerNames.querySelector(".executor__img");function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(2222),n(9554),n(6992),n(189),n(8783),n(4747),n(3948);var g=dropdownClient.querySelector(".dropdown__list"),w=document.getElementById("managerNames").querySelector(".dropdown__list"),b=function(e){var t=e.name,n=e.hash,r=e.avatar;return'\n  <li data-name="'.concat(t,'" data-hash="').concat(n,'">\n    <img src="').concat(""!==r&&r?r:"img/icon/ava-empty.svg",'" alt="" class="executor__img">\n    ').concat(t,"\n  </li>\n")},x=function(e){var t,n,r,a,o,i,c,s="",l="",u=[],d=new Set,f=new Set,m=new Set,p=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}(e.docs);try{for(p.s();!(t=p.n()).done;){var h=t.value;d.add(h.user.name),f.add(h.user.hash),m.add(h.user.avatar),s+=(void 0,void 0,void 0,void 0,void 0,r=(n=h).name,a=n.hash,o=n.email,i=n.phone,c=n.user,'\n  <li data-name="'.concat(r,'" data-hash="').concat(a,'" data-email="').concat(o,'" data-phone="').concat(i,'" data-manager="').concat(c.name,'">').concat(r,"</li>\n"))}}catch(e){p.e(e)}finally{p.f()}d.forEach((function(e){u.push({name:e})}));var v=0;f.forEach((function(e){u[v].hash=e,v++}));var x=0;m.forEach((function(e){u[x].avatar=e,x++}));for(var S=0,E=u;S<E.length;S++){var _=E[S];l+=b(_)}g.insertAdjacentHTML("afterbegin",s),w.insertAdjacentHTML("afterbegin",l)};function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=document.getElementById("dropdownTags"),_=E.querySelector(".dropdown__list"),j=E.querySelector(".priority__circle"),k={"Низкий":"green","Высокий":"yellow","Срочный":"red"},L=function(e){var t,n,r,a,o="",i=!1,c=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}(e);try{for(c.s();!(t=c.n()).done;){var s=t.value;"priority"===s.kind&&(o+=(void 0,void 0,r=(n=s).name,a=n.hash,'\n  <li>\n    <div class="priority__circle '.concat(k[r]||"",'" data-name="').concat(r,'" data-hash="').concat(a,'"></div>\n    ').concat(r,"\n  </li>\n")),i||(dealPriority.value=s.name,j.classList.add("".concat(k[s.name]||"")),i=!0))}}catch(e){c.e(e)}finally{c.f()}_.insertAdjacentHTML("afterbegin",o)},C=n(5096),I=new(n.n(C)())({allErrors:!0}).compile({$schema:"http://json-schema.org/draft-07/schema#",title:"createLead",description:"Schema for create Leads data",type:"object",properties:{title:{type:"string"},amount:{type:"number"},pipeline:{type:"string"},clientHash:{type:"string"},status:{type:"string"},deadline:{type:"string"},comment:{type:"string"}},additionalProperties:!1,required:["title","amount","pipeline","clientHash","status","deadline","comment"]});function T(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){T(o,r,a,i,c,"next",e)}function c(e){T(o,r,a,i,c,"throw",e)}i(void 0)}))}}var A=Object.freeze({getClients:{fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(B(regeneratorRuntime.mark((function e(){var t,n,r,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/clients"),{method:"GET",headers:{accept:"application/json","x-token":i(),"Content-Type":"application/json"}});case 2:if((t=e.sent).ok){e.next=10;break}return e.next=6,t.json();case 6:throw n=e.sent,r=n.message,a().error(r,"Ошибка!"),new Error(r);case 10:return e.next=12,t.json();case 12:c=e.sent,s=c.data,x(s);case 15:case"end":return e.stop()}}),e)}))))},getTags:{fetch:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(B(regeneratorRuntime.mark((function e(){var t,n,r,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/settings/tags"),{method:"GET",headers:{accept:"application/json","x-token":i()}});case 2:if((t=e.sent).ok){e.next=10;break}return e.next=6,t.json();case 6:throw n=e.sent,r=n.message,a().error(r,"Ошибка!"),new Error(r);case 10:return e.next=12,t.json();case 12:c=e.sent,s=c.data,L(s);case 15:case"end":return e.stop()}}),e)}))))},createLead:{fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=B(regeneratorRuntime.mark((function e(t){var n,r,c,s,l,u,d,f,m,p,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.title,r=t.amount,c=t.pipeline,s=t.clientHash,l=t.status,u=t.deadline,d=t.comment,I(f={title:n,amount:r,pipeline:c,clientHash:s,status:l,deadline:u,comment:d})){e.next=8;break}throw m="Форма заполнена не полностью. Проверьте правильность заполнения полей.",a().error(m,"Ошибка!"),console.error(I.errors),new Error(m);case 8:return e.next=10,fetch("".concat(o,"/leads"),{method:"POST",headers:{accept:"application/json","x-token":i(),"Content-Type":"application/json"},body:JSON.stringify(f)});case 10:if((p=e.sent).ok){e.next=18;break}return e.next=14,p.json();case 14:throw h=e.sent,v=h.message,a().error(v,"Ошибка!"),new Error(v);case 18:window.location.href="leads.html";case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),q=n(1448),P=n.n(q);function D(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}var O,R=document.getElementById("dealName"),N=document.getElementById("dealCost"),H=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,a,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=R.value,n=+N.value,r=dealClient.dataset.hash,a=dealPriority.value,o=deasDeadline.dataset.date,i=dealComment.value,e.next=9,A.createLead.fetch({title:t,amount:n,pipeline:"new",clientHash:r,status:a,deadline:o,comment:i});case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){D(o,r,a,i,c,"next",e)}function c(e){D(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),M=document.querySelectorAll(".dropdown"),G=document.getElementById("cancelBtn"),$=function(){dealName.value.length>=1?dealName.classList.add("filled"):dealName.classList.remove("filled"),dealCost.value.length>=1?dealCost.classList.add("filled"):dealCost.classList.remove("filled")};function U(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}document.getElementById("dropdownClient"),document.getElementById("dealClient"),document.getElementById("deasDeadline"),document.getElementById("formCreateLead"),document.getElementById("dealExecutor"),(O=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getClients.fetch();case 2:return e.next=4,A.getTags.fetch();case 4:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(n,r){var a=O.apply(e,t);function o(e){U(a,n,r,o,i,"next",e)}function i(e){U(a,n,r,o,i,"throw",e)}o(void 0)}))})(),formCreateLead.onclick=function(e){e.preventDefault();var t=e.target.closest(".dropdown");if(t){var n=t.querySelector("input");t.classList.contains("open")?(t.classList.remove("open"),n.blur()):(t.classList.add("open"),n.focus()),$()}},document.body.onclick=function(e){var t=e.target;if("submit"===t.type)H();else if(t===G)confirm("Вы уверены?")&&(document.location.href="leads.html");else{if(t=t.closest(".dropdown"))return;M.forEach((function(e){e.classList.contains("open")&&e.classList.remove("open")})),$()}},P()(deasDeadline,{formatter:function(e,t,n){var r=t.toLocaleDateString("en-GB");deasDeadline.dataset.date=t.toISOString(),e.value=r},position:"bl",startDay:1,customDays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],customMonths:["Янв","Февр","Март","Арпрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],overlayButton:"К дате!",overlayPlaceholder:"Enter a 4-digit year",dateSelected:new Date,minDate:new Date}).calendarContainer.style.setProperty("width","100%"),c.onclick=function(e){var t=e.target.closest("li");t&&(s.value=t.dataset.name,s.dataset.hash=t.dataset.hash,l.value=t.dataset.phone,u.value=t.dataset.email,d.value=t.dataset.manager,""!==d.value&&(f.classList.remove("closed-img"),f.classList.add("opened-img")))},m.onclick=function(e){var t=e.target.closest("li");t&&(dealPriority.value=t.querySelector(".priority__circle").dataset.name,p.classList.value=t.querySelector(".priority__circle").classList.value)},h.onclick=function(e){var t=e.target.closest("li");t&&(dealExecutor.value=t.dataset.name,dealExecutor.dataset.hash=t.dataset.hash,""!==dealExecutor.value&&(v.classList.remove("closed-img"),v.classList.add("opened-img")))}}},t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.x=function(){},n.amdD=function(){throw new Error("define cannot be used indirect")},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={737:0},t=[[6295,29,855,714,936,132]],r=function(){},a=function(a,o){for(var i,c,s=o[0],l=o[1],u=o[2],d=o[3],f=0,m=[];f<s.length;f++)c=s[f],n.o(e,c)&&e[c]&&m.push(e[c][0]),e[c]=0;for(i in l)n.o(l,i)&&(n.m[i]=l[i]);for(u&&u(n),a&&a(o);m.length;)m.shift()();return d&&t.push.apply(t,d),r()},o=self.webpackChunkjs_personal_projects=self.webpackChunkjs_personal_projects||[];function i(){for(var r,a=0;a<t.length;a++){for(var o=t[a],i=!0,c=1;c<o.length;c++){var s=o[c];0!==e[s]&&(i=!1)}i&&(t.splice(a--,1),r=n(n.s=o[0]))}return 0===t.length&&(n.x(),n.x=function(){}),r}o.forEach(a.bind(null,0)),o.push=a.bind(null,o.push.bind(o));var c=n.x;n.x=function(){return n.x=c||function(){},(r=i)()}}(),n.x()}();